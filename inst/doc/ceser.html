<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introdution to ceser</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introdution to ceser</h1>



<div id="summary" class="section level2">
<h2>Summary</h2>
<p>The <strong>ceser</strong> package contains an implementation in R of the Cluster Estimated Standard Error (CESE) method proposed by <span class="citation">Jackson (2019)</span>. The method estimates the covariance matrix of the estimated coefficients of linear models in grouped data sets with correlation among observations within groups. CESE is an alternative solution for the classical Cluster Robust Standard Error (CRSE) (<span class="citation">Greene (2012)</span>,<span class="citation">Eicker (1967)</span>,<span class="citation">White (1980)</span>,<span class="citation">Liang and Zeger (1986)</span>,<span class="citation">MacKinnon and Webb (2017)</span>), which underestimates the standard errors in most of the situations encountered in practice (<span class="citation">Esarey and Menger (2018)</span>).</p>
</div>
<div id="technical-details" class="section level2">
<h2>Technical Details</h2>
<p><span class="citation">Jackson (2019)</span> proposes an approach labeled CESE to estimate the standard errors in grouped data with within-group correlation in the residuals. The approach is based on the estimated expectation of the product of the residuals. Assuming that the residuals have the same variance-covariance matrix within the groups, if we denote by <span class="math inline">\(\sigma_{ig} = \sigma_{g}^{2}\)</span> and <span class="math inline">\(\rho_{ig} = \rho_{g}\)</span> the variance and covariance, respectively, of the residuals within the group <span class="math inline">\(g\)</span>, then the expectation of the product of the residuals is given by (see <span class="citation">Jackson (2019)</span> for details):</p>
<p><span class="math display">\[\begin{align}
\displaystyle\label{eq-exp-ee}
\begin{split}
\Sigma_g = \mathbb{E}[e_g e_g^T] =  \sigma_{g}^{2} (I_g - P_g) +  \rho_{g} \bigg[ \iota_{g} \iota_{g}^{T} - (I_g - P_g) - (P_g \iota_{g} \iota_{g}^{T} + \iota_{g} \iota_{g}^{T} P_g) \\
 + X_g(X^{T}X)^{-1} \left( \sum_{g=1}^{G} X_{g}^{T}\iota_{g} \iota_{g}^{T} X_g \right)(X^{T}X)^{-1}X_g \bigg]
\end{split}
\end{align}\]</span></p>
<p>where <span class="math inline">\(\iota_{g}\)</span> is a unitary column vector, <span class="math inline">\(I_g\)</span> is a <span class="math inline">\(g \times g\)</span> identity matrix, and <span class="math inline">\(P_g = X_g (X^{T}X)^{-1}X_{g}^{T}\)</span>. The equation above can be rewritten concisely as:</p>
<p><span class="math display">\[\begin{align}
\displaystyle\label{eq-exp-ee-reduced}
\Sigma_{g}^{} = \sigma_{g}^{2} Q_{1g} + \rho_{g} Q_{2g}.
\end{align}\]</span></p>
<p>This equation explicitly shows that the expectation of the cross-product of the residuals is a function the data through <span class="math inline">\(Q_{1g}\)</span>, <span class="math inline">\(Q_{2g}\)</span>, the unknown variance <span class="math inline">\(\sigma_{g}^{2}\)</span>, and correlation <span class="math inline">\(\rho_{g}\)</span> of the residuals <span class="math inline">\(e_g\)</span> in each group <span class="math inline">\(g\)</span>. The CESE solution is to explore the linear structure of that equation and estimate <span class="math inline">\(\sigma_{g}^{2}\)</span> and <span class="math inline">\(\rho_{g}\)</span> <em>as if</em> the estimated values of <span class="math inline">\(e_g e_{g}^{T}\)</span> were random deviances from their expectations. Denote <span class="math inline">\(\xi\)</span> that deviance. Then</p>
<p><span class="math display">\[\begin{align}
\displaystyle\label{eq-cese-reg}
\begin{split}
e_g e_{g}^{T} &amp;= \mathbb{E}[e_g e_{g}^{T}] + \xi \\
&amp;=  \sigma_{g}^{2} Q_{1g} + \rho_{g} Q_{2g} + \xi \\
&amp;= \Sigma_{g}^{} + \xi.
\end{split}
\end{align}\]</span></p>
<p>The estimates of <span class="math inline">\(\sigma_{g}^{2}\)</span> and <span class="math inline">\(\rho_{g}\)</span> are obtained using the OLS estimator. That is, if we denote <span class="math inline">\(\Omega_g = (\sigma_{g}^{2} , \rho_{g} )^{T}\)</span>, <span class="math inline">\(q_{1g}\)</span> (or <span class="math inline">\(q_{2g}\)</span>) the vectorized diagonal and lower triangle of <span class="math inline">\(Q_{1g}\)</span> (or <span class="math inline">\(Q_{2g}\)</span>) stacked into a <span class="math inline">\(n_g(n_g + 1)/2\)</span> column vector, <span class="math inline">\(q_g = [q_{1g}, q_{2g}]\)</span>, and <span class="math inline">\(s_{eg}\)</span> the corresponding elements of <span class="math inline">\(e_g e_{g}^{T}\)</span> stacked into a column vector as well, then the OLS CESE estimator <span class="math inline">\(\hat{\Omega}_{g} = (\hat{\sigma}_{g}^{2} , \hat{\rho}_{g} )^{T}\)</span> of the variance and correlation of the residuals in group <span class="math inline">\(g\)</span> is given by</p>
<p><span class="math display">\[
\hat{\Omega}_g = \text{arg min}_{\Omega_g } (s_{eg} - q_{g}\Omega_{g} )^{T}(s_{eg} - q_{g}\Omega_{g} ).
\]</span></p>
<p>If we assume that <span class="math inline">\(q_{g}^{T}q_{g}\)</span> is invertible, the first order condition gives:</p>
<p><span class="math display">\[\begin{align}
\displaystyle\label{eq-cese-concise}
\hat{\Omega}_{g} = (q_g^{T}q_g)^{-1}q_g^{T}s_{eg}.
\end{align}\]</span></p>
<p>We can rewrite the equation above as:</p>
<p><span class="math display">\[\begin{align}
\displaystyle\label{eq-cese-matrix }
\begin{bmatrix}
\hat{\sigma}_{g}^{2} \\
\hat{\rho}_{g}
\end{bmatrix} =
\begin{bmatrix}
    q_{1g}^{T}q_{1g} &amp;   q_{1g}^{T}q_{2g}\\
    q_{2g}^{T}q_{1g} &amp;   q_{2g}^{T}q_{2g}
\end{bmatrix}^{-1}
\begin{bmatrix}
    q_{1g}^{T}s_{eg} \\
    q_{2g}^{T}s_{eg}
\end{bmatrix}.
\end{align}\]</span></p>
<p>The estimators of <span class="math inline">\(\sigma_{g}^{2}\)</span> and <span class="math inline">\(\rho_{g}\)</span> do not require  any assumption on <span class="math inline">\(\xi\)</span>, unless we want to construct confidence intervals for the estimates of those parameters.</p>
<p><span class="citation">Jackson (2019)</span> shows that CESE produces larger standard errors for the coefficients and much more conservative confidence intervals than the CRSE, which is known to be biased downward. CESE is also less sensitive to the number of clusters and to the heterogeneity of the clusters, which can be a problem for both CRSE and bootstrap methods.</p>
</div>
<div id="implementation" class="section level2">
<h2>Implementation</h2>
<p>The package <strong>CESER</strong> provides a function <code>vcovCESE()</code> that takes the output of the function <code>lm()</code> (or any other that produces compatible outputs) and computes the CESE. The basic structure of the function is:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">vcovCESE</span>(mod, <span class="dt">cluster =</span> <span class="ot">NULL</span>, <span class="dt">type=</span><span class="ot">NULL</span>)</a></code></pre></div>
<p>The parameter <code>mod</code> receives the output of the <code>lm()</code> function. The parameter <code>cluster</code> can receive a right-hand side R formula with the summation of the variables in the data that will be used to cluster the standard errors. For instance, if one wants to cluster the standard error by country, one can use:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">vcovCESE</span>(..., <span class="dt">cluster =</span> <span class="op">~</span><span class="st"> </span>country, ...)</a></code></pre></div>
<p>To cluster by country and gender, simply use:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">vcovCESE</span>(..., <span class="dt">cluster =</span> <span class="op">~</span><span class="st"> </span>country <span class="op">+</span><span class="st"> </span>gender, ...)</a></code></pre></div>
<p>The parameter <code>cluster</code> can also receive, instead of a formula, a string vector with the name of the variables that contain the groups to cluster the standard errors. If <code>cluster = NULL</code>, each observation is considered its own group to cluster the standard errors.</p>
<p>The parameter <code>type</code> receives the procedure to use for heterokedasticity correction. Heterokedasticity occurs when the diagonal elements of <span class="math inline">\(\Sigma\)</span> are not constant across observations. The correction can also be used to deal with underestimation of the true variance of the residuals due to leverage produced by outliers. We include five types of correction. In particular, <code>type</code> can be either “HC0”, “HC1”, “HC2”, “HC3”, and “HC4” (<span class="citation">Hayes and Cai (2007)</span>). Denote <span class="math inline">\(e_c\)</span> the corrected residuals. Each option produce the following corretion:</p>
<p>\begin{array}{l@{}l} \  &amp; e_{ic} = e_i \  &amp; e_{ic} = e_i (  ) \  &amp; e_{ic} = e_i (  ) \  &amp; e_{ic} = e_i (  ) \  &amp; e_{ic} = e_i (  )\ \ \end{array}</p>
<p>where <span class="math inline">\(k\)</span> is the number of covariates, <span class="math inline">\(h_{ii}\)</span> is the <span class="math inline">\(i^{th}\)</span> diagonal element of the matrix <span class="math inline">\(P=X(X^{T}X)^{-1}X^{T}\)</span>, and <span class="math inline">\(\delta_{i} = \min(4, h_{ii}\frac{n}{k} )\)</span>.</p>
<p>The estimation also corrects for cases in which <span class="math inline">\(\rho_{g} &gt; \sigma^2{g}\)</span>. Following <span class="citation">Jackson (2019)</span>, we use <span class="math inline">\(\hat{\sigma}_{g}^{2} = (\hat{\rho}_g + 0.02 )\)</span> in those cases.</p>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<p>To ilustrate how to use the <strong>ceser</strong> package, we use the data set <code>dcese</code>, which is provided with the package. The data set contains information of 310 (i=1,…, 310) observations across 51 countries (g=1,…,51).</p>
<p>The outcome variable is the number of effective legislative parties (<em>enep</em>). The explanatory variables are: the number of presidential candidates (<em>enpc</em>); a measure of presidential power (<em>fapres</em>); the proximity of presidential and legislative elections (<em>proximity</em>); the effective number of ethnic groups (<em>eneg</em>); the log of average district magnitudes (<em>logmag</em>); an interaction term between the number of presidential candidates and the presidential power (<em>enpcfapres</em> = <em>enpc</em> <span class="math inline">\(\times\)</span> <em>fapres</em>), and another interaction term between the log of the district magnitude and the number of ethnic groups (<em>logmag_eneg</em> = <em>logmag</em> <span class="math inline">\(\times\)</span> <em>eneg</em>). In the example below, we regress <em>enpc</em> on <em>fapres</em>, <em>enpc</em>, their interaction, and other controls.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">library</span>(ceser)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt;  ## ------------------------------------------</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt;  ## Cluster Estimated Standard Errors  (ceser)</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt;  ## ------------------------------------------</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt;  Author(s): Diogo Ferrari and John Jackson</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="kw">data</span>(dcese)</a></code></pre></div>
<p>Let’s estimate a linear model using the <code>lm()</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">mod  =<span class="st"> </span><span class="kw">lm</span>(enep <span class="op">~</span><span class="st">  </span>enpc <span class="op">+</span><span class="st"> </span>fapres <span class="op">+</span><span class="st"> </span>enpcfapres <span class="op">+</span><span class="st"> </span>proximity</a>
<a class="sourceLine" id="cb5-2" title="2">                       <span class="op">+</span><span class="st"> </span>eneg <span class="op">+</span><span class="st"> </span>logmag <span class="op">+</span><span class="st"> </span>logmag_eneg , <span class="dt">data=</span>dcese)</a></code></pre></div>
<p>For all the examples below, we use the HC3 correction. To compute the variance covariance matrix of the estimated coefficients <span class="math inline">\(\hat{\beta}\)</span> using clustered standard errors by country, just execute:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">vcovCESE</span>(mod, <span class="dt">cluster =</span> <span class="op">~</span>country, <span class="dt">type=</span><span class="st">&quot;HC3&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt;             (Intercept)          enpc       fapres    enpcfapres    proximity</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt; (Intercept)  1.59804215 -0.3565889644 -0.326044522  0.0928614018 -0.086958688</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; enpc        -0.35658896  0.1254735451  0.104834222 -0.0354704134 -0.003332760</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt; fapres      -0.32604452  0.1048342220  0.143205927 -0.0389793642 -0.017878997</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; enpcfapres   0.09286140 -0.0354704134 -0.038979364  0.0126978025  0.003217871</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt; proximity   -0.08695869 -0.0033327597 -0.017878997  0.0032178709  0.139694748</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt; eneg        -0.08737194  0.0028258190 -0.007080605  0.0010940285 -0.005680272</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; logmag      -0.22422347  0.0009844983  0.006687954  0.0038080340  0.009776123</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; logmag_eneg  0.08380931 -0.0058250477 -0.011500450  0.0008568949  0.004471824</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt;                     eneg        logmag   logmag_eneg</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt; (Intercept) -0.087371945 -0.2242234723  0.0838093142</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#&gt; enpc         0.002825819  0.0009844983 -0.0058250477</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">#&gt; fapres      -0.007080605  0.0066879544 -0.0115004496</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt; enpcfapres   0.001094029  0.0038080340  0.0008568949</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">#&gt; proximity   -0.005680272  0.0097761226  0.0044718243</span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt; eneg         0.039433115  0.0481561426 -0.0231003489</span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt; logmag       0.048156143  0.2244236813 -0.1048418029</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">#&gt; logmag_eneg -0.023100349 -0.1048418029  0.0606625677</span></a></code></pre></div>
<p>We can obtain the summary table with CESE by country by running:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">library</span>(lmtest)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt; Loading required package: zoo</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; Attaching package: &#39;zoo&#39;</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt;     as.Date, as.Date.numeric</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="kw">coeftest</span>(mod, <span class="dt">vcov =</span> vcovCESE, <span class="dt">cluster =</span> <span class="op">~</span><span class="st"> </span>country, <span class="dt">type=</span><span class="st">&quot;HC3&quot;</span>)</a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt; t test of coefficients:</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)  </span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt; (Intercept)  2.704309   1.264137  2.1393  0.03325 *</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">#&gt; enpc         0.303988   0.354222  0.8582  0.39150  </span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">#&gt; fapres      -0.611787   0.378426 -1.6167  0.10703  </span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">#&gt; enpcfapres   0.207791   0.112685  1.8440  0.06620 .</span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">#&gt; proximity   -0.022429   0.373758 -0.0600  0.95219  </span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">#&gt; eneg        -0.065662   0.198578 -0.3307  0.74114  </span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">#&gt; logmag      -0.181462   0.473734 -0.3830  0.70197  </span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">#&gt; logmag_eneg  0.360513   0.246298  1.4637  0.14435  </span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a></code></pre></div>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-eicker1967limit">
<p>Eicker, Friedhelm. 1967. “Limit Theorems for Regressions with Unequal and Dependent Errors.” In <em>Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probability</em>, 1:59–82. 1.</p>
</div>
<div id="ref-esarey2018practical">
<p>Esarey, Justin, and Andrew Menger. 2018. “Practical and Effective Approaches to Dealing with Clustered Data.” <em>Political Science Research and Methods</em>, 1–19.</p>
</div>
<div id="ref-greene2003econometric">
<p>Greene, William H. 2012. <em>Econometric Analysis</em>. Upper Saddle River, NJ: Pearson Prentice Hall. <a href="http://mirlyn.lib.umich.edu/Record/009998038">http://mirlyn.lib.umich.edu/Record/009998038</a>.</p>
</div>
<div id="ref-hayes2007using">
<p>Hayes, Andrew F, and Li Cai. 2007. “Using Heteroskedasticity-Consistent Standard Error Estimators in Ols Regression: An Introduction and Software Implementation.” <em>Behavior Research Methods</em> 39 (4): 709–22.</p>
</div>
<div id="ref-jackson2019cese">
<p>Jackson, John. 2019. “Corrected Standard Errors with Clustered Data.” <em>Political Analysis</em> forthcoming.</p>
</div>
<div id="ref-liang1986longitudinal">
<p>Liang, Kung-Yee, and Scott L Zeger. 1986. “Longitudinal Data Analysis Using Generalized Linear Models.” <em>Biometrika</em> 73 (1): 13–22.</p>
</div>
<div id="ref-mackinnon2017wild">
<p>MacKinnon, James G, and Matthew D Webb. 2017. “Wild Bootstrap Inference for Wildly Different Cluster Sizes.” <em>Journal of Applied Econometrics</em> 32 (2): 233–54.</p>
</div>
<div id="ref-white1980heteroskedasticity">
<p>White, Halbert L. 1980. “A Heteroskedasticity-Consistent Covariance Matrix Estimator and a Direct Test for Heteroskedasticity.” <em>Econometrica</em> 48 (4): 817–38.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
